<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Données des Astéroïdes</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #0b0c10;
      color: #ffffff;
      margin: 0;
      padding: 20px;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
    }

    #search-container {
      text-align: center;
      margin-bottom: 20px;
    }

    #search-input {
      padding: 10px;
      width: 80%;
      max-width: 400px;
      border: 2px solid #66fcf1;
      border-radius: 10px;
      background-color: #1f2833;
      color: white;
    }

    #asteroids-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }

    .asteroid-card {
      background-color: #1f2833;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s ease;
      cursor: pointer;
    }

    .asteroid-card:hover {
      transform: translateY(-5px);
    }

    .return-link {
      text-align: center;
      margin-top: 30px;
    }

    .return-link a {
      color: #66fcf1;
      text-decoration: none;
      font-weight: bold;
      font-size: 1.1rem;
    }

    /* Styles pour la pop-up */
    .popup-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .popup-content {
      background-color: #1f2833;
      padding: 20px;
      border-radius: 10px;
      max-width: 400px;
      width: 90%;
      color: #ffffff;
      animation: fadeIn 0.5s;
      position: relative;
    }

    .popup-content h2 {
      margin-top: 0;
    }

    .close-popup {
      position: absolute;
      top: 10px;
      right: 15px;
      background: none;
      border: none;
      color: #ffffff;
      font-size: 1.5rem;
      cursor: pointer;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
  </style>
</head>
<body>
  <header>
    <h1>Données des Astéroïdes</h1>
    <p>Voici les données des astéroïdes reçues depuis l'API de la NASA.</p>
  </header>

  <div id="search-container">
    <input type="text" id="search-input" placeholder="Rechercher un astéroïde par nom..." oninput="filterAsteroids()">
  </div>

  <div id="asteroids-container">
    <!-- Les cartes d’astéroïdes s’afficheront ici -->
  </div>

  <div class="return-link">
    <a href="index.html">⬅️ Retour à l'accueil</a>
  </div>

  <!-- Pop-up -->
  <div class="popup-overlay" id="popup-overlay">
    <div class="popup-content" id="popup-content">
      <button class="close-popup" id="close-popup">&times;</button>
      <h2 id="popup-name"></h2>
      <p><strong>Vitesse relative :</strong> <span id="popup-speed"></span> km/h</p>
      <p><strong>Date de passage :</strong> <span id="popup-date"></span></p>
      <p><strong>Diamètre estimé :</strong> <span id="popup-diameter"></span> km</p>
      <p><strong>Distance minimale :</strong> <span id="popup-distance"></span> km</p>
    </div>
  </div>

  <script>
    let asteroidsData = [];

    async function fetchAsteroidsData() {
      const start_date = "2025-05-01";
      const end_date = "2025-05-08";
      const api_key = "0mOIG3D2i5Bu3MNauyX1hznLdR8adSZOKDbfZVZc";

      const response = await fetch(`https://api.nasa.gov/neo/rest/v1/feed?start_date=${start_date}&end_date=${end_date}&api_key=${api_key}`);
      const data = await response.json();

      const asteroids = data.near_earth_objects;
      asteroidsData = [];

      for (const date in asteroids) {
        asteroids[date].forEach((asteroid) => {
          asteroidsData.push({
            name: asteroid.name,
            speed: asteroid.close_approach_data[0].relative_velocity.kilometers_per_hour,
            date: asteroid.close_approach_data[0].close_approach_date,
            diameter: Number(asteroid.estimated_diameter.kilometers.estimated_diameter_max).toFixed(2),
            distance: Number(asteroid.close_approach_data[0].miss_distance.kilometers).toLocaleString()
          });
        });
      }

      displayAsteroids(asteroidsData);
    }

    function displayAsteroids(asteroids) {
      const container = document.getElementById('asteroids-container');
      let output = '';

      asteroids.forEach(asteroid => {
        output += `
          <div class="asteroid-card" data-name="${asteroid.name}" data-speed="${asteroid.speed}" data-date="${asteroid.date}" data-diameter="${asteroid.diameter}" data-distance="${asteroid.distance}">
            <h2>${asteroid.name}</h2>
            <p><strong>Diamètre estimé :</strong> ${asteroid.diameter} km</p>
            <p><strong>Distance minimale :</strong> ${asteroid.distance} km</p>
          </div>
        `;
      });

      container.innerHTML = output;

      // Ajouter des écouteurs d'événements aux cartes
      document.querySelectorAll('.asteroid-card').forEach(card => {
        card.addEventListener('click', () => {
          document.getElementById('popup-name').textContent = card.getAttribute('data-name');
          document.getElementById('popup-speed').textContent = Number(card.getAttribute('data-speed')).toLocaleString();
          document.getElementById('popup-date').textContent = card.getAttribute('data-date');
          document.getElementById('popup-diameter').textContent = card.getAttribute('data-diameter');
          document.getElementById('popup-distance').textContent = card.getAttribute('data-distance');
          document.getElementById('popup-overlay').style.display = 'flex';
        });
      });

      // Fermer la pop-up
      document.getElementById('close-popup').addEventListener('click', () => {
        document.getElementById('popup-overlay').style.display = 'none';
      });

      // Fermer la pop-up en cliquant en dehors du contenu
      document.getElementById('popup-overlay').addEventListener('click', (e) => {
        if (e.target === document.getElementById('popup-overlay')) {
          document.getElementById('popup-overlay').style.display = 'none';
        }
      });
    }

    function filterAsteroids() {
      const query = document.getElementById('search-input').value.toLowerCase();
      const filteredAsteroids = asteroidsData.filter(asteroid => asteroid.name.toLowerCase().includes(query));
      displayAsteroids(filteredAsteroids);
    }

    fetchAsteroidsData();
  </script>
</body>
</html>

